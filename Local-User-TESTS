Testing Detection and REmediation Scripts


HOW TO TEST ON YOUR PC (Right Now)
Step 1: 
Delete the user first (if it exists)

#open powershell and execute this: 
Remove-LocalUser -Name "user" -ErrorAction SilentlyContinue


Step 2: Save both scripts to C:\Temp\

#Save The Detect and Remediation Scripts into C:\temp folder
C:\Temp\Detect-LAPSUser.ps1
C:\Temp\Remediate-LAPSUser.ps1

Step 3: Test Detection (should fail - user doesn't exist yet)

Run: powershell again 
powershell.exe -ExecutionPolicy Bypass -File C:\Temp\Detect-LAPSUser.ps1
echo "Exit code: $LASTEXITCODE"

Step 3.1: Expectation
Expected: Exit code 1 (user missing, needs remediation)

Step 4: Run Remediation
powershell.exe -ExecutionPolicy Bypass -File C:\Temp\Remediate-LAPSUser.ps1
echo "Exit code: $LASTEXITCODE"
Expected: Exit code 0 (user created)

Step 5: Test Detection Again (should pass)
powershell
powershell.exe -ExecutionPolicy Bypass -File C:\Temp\Detect-LAPSUser.ps1
echo "Exit code: $LASTEXITCODE"
Expected: Exit code 0 (user is LAPS-ready)

Step 6: Verify Manually
powershell
Get-LocalUser "user" | Select-Object Name, Enabled, PasswordNeverExpires
Get-LocalGroupMember -Group "Administrators" | Where-Object {$_.Name -like "*user"}
